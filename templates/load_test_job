apiVersion: batch/v1
kind: Job
metadata:
  labels:
    stress-test-label: {{ .testLabel }}
  name: stress-test-job-{{ .instanceName }}
  namespace: {{ .namespace }}
spec:
  containers:
    - name: stree-test
      image: nuc.lliu.ca/lliu/scale_maker:56
      command: ["/bin/bash"]
      args: ["-c", "stress-ng {{ .commandParams }}"]
      livenessProbe:
        exec:
          command:
          - /bin/true
      readinessProbe:
        exec:
          command:
          - /bin/true
      resources:
        requests:
          cpu: "{{ .cpuRequest }}"
          memory: "{{ .memoryRequest }}"
        limits:
          cpu: "{{ .cpuLimit }}"
          memory: "{{ .memoryLimit }}"
      securityContext: {}
  restartPolicy: Never
  backoffLimit: 3
  ttlSecondsAfterFinished: 300
